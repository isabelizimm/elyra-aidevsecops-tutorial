== Test inference application deployed

If you want to test your application deployed in the cluster you can run
the
https://github.com/thoth-station/elyra-aidevsecops-tutorial/tree/master/features[integration
test] using https://behave.readthedocs.io/en/stable/[behave] package.

Behave uses Behavior-driven development (or BDD), an agile software
development technique that encourages and faciliate collaboration
between developers, QA and non-technical or business participants.

[arabic]
. Install https://github.com/thoth-station/thamos[thamos] using pip:

[source,bash]
----
  pip install thamos
----

[arabic, start=2]
. Create an env and install dependencies using
https://github.com/thoth-station/thamos[thamos] from the root directory
of the tutorial, selecting the appropriate overlays `test-model`.

[source,bash]
----
  python3 -m venv venv/ && . venv/bin/activate && thamos install -r test-model
----

[arabic, start=3]
. Run https://behave.readthedocs.io/en/stable/[behave] command from the
root directory of the tutorial.

[source,bash]
----
  DEPLOYED_MODEL_URL=http://elyra-aidevsecops-tutorial-thoth-deployment-examples.apps.zero.massopen.cloud behave
----

Example of the output received:

[source,bash]
----
  Scenario: Deployment metrics gathering                    # features/gather_deployment_metrics.feature:2
      Given dataset is available                            # features/steps/model_deployment.py:42
      Given deployment is accessible                        # features/steps/model_deployment.py:56
      When I run test to gather metrics on predict endpoint # features/steps/model_deployment.py:72
      Then I should get model and application metrics       # features/steps/model_deployment.py:128

  1 feature passed, 0 failed, 0 skipped
  1 scenario passed, 0 failed, 0 skipped
  4 steps passed, 0 failed, 0 skipped, 0 undefined
  Took 0m3.394s
----

[arabic, start=4]
. Checking metrics produced running

[source,bash]
----
  cat metrics.json
----

[source,python]
----
{'average_latency': 0.03846242621075362, 'average_error': 0.001}
----

=== References

* https://behave.readthedocs.io/en/stable/[behave]
* https://github.com/thoth-station/thamos[thamos]
